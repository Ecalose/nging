function removeIPv4Domain(e,t){var n=e.parent(),a=e.data("index");var i=n.find(".input-group[data-index]:last").data("index");e.remove();if(i==a){return}var r="DNSServices["+t+"][IPv4Domains][";resortDomain(n,r)}function removeIPv6Domain(e,t){var n=e.parent(),a=e.data("index");var i=n.find(".input-group[data-index]:last").data("index");e.remove();if(i==a){return}var r="DNSServices["+t+"][IPv6Domains][";resortDomain(n,r)}function resortDomain(e,a){e.find(".input-group[data-index]").each(function(t){var e=$(this);var n=e.data("index");if(t==n)return;e.attr("data-index",t).data("index",t);e.find('[name^="'+a+'"]').each(function(){var e=$(this).attr("name");e=e.substring(a.length);e=e.replace(/^[0-9]+/,t);e=a+e;$(this).attr("name",e)})})}function addIPv4Domain(e,t,n){var a=e.find(".input-group[data-index]:last").data("index");var i=a===undefined?0:a+1;var r=template("tmpl-domain-row",{k:t,domainK:i,supportLine:n,ipVer:4});e.append(r)}function addIPv6Domain(e,t,n){var a=e.find(".input-group[data-index]:last").data("index");var i=a===undefined?0:a+1;var r=template("tmpl-domain-row",{k:t,domainK:i,supportLine:n,ipVer:6});e.append(r)}function addWebhook(){var e=$(".ddns-webhook:last").data("index");var t=e===undefined?0:e+1;var n=template("tmpl-webhook-row",{k:t});$("#ddns-form-submit-group").before(n)}function syncWebhookName(e){var t=$(e).data("index");$("#ddns-webhook-name-"+t).text($(e).val()||App.t("未命名")+"("+t+")")}function removeWebhook(e){var t=$(e).closest("div.ddns-webhook"),n=t.data("index");if(confirm("确定要删除Webhook“"+$("#ddns-webhook-name-"+n).text()+"”吗？")){var a=$(".ddns-webhook:last").data("index");t.remove();if(a==n){return}resortWebhook()}}function resortWebhook(){var a="Webhooks[";$(".ddns-webhook").each(function(t){var e=$(this);var n=e.data("index");if(t==n)return;e.attr("data-index",t).data("index",t);e.find("[data-index]").attr("data-index",t).data("index",t);e.find('[name^="'+a+'"]').each(function(){var e=$(this).attr("name");e=e.substring(a.length);e=e.replace(/^[0-9]+/,t);e=a+e;$(this).attr("name",e)});e.attr("id","ddns-webhook-"+t);e.find("#ddns-webhook-name-"+n).attr("id","ddns-webhook-name-"+t)})}var ipv4NetInterfaceIPRule="IPv4[NetInterface][Filter][Include]",ipv6NetInterfaceIPRule="IPv6[NetInterface][Filter][Include]";function insertNetIfaceRegexpTag(e){var t=e==6?ipv6NetInterfaceIPRule:ipv4NetInterfaceIPRule;var n=$('input[name="'+t+'"]').val();if(/^regexp:/.test(n))return;$('input[name="'+t+'"]').val("regexp:"+n)}$(function(){$("#ddns-form").off().on("submit",function(e){e.preventDefault();$.post(window.location.href,$(this).serialize(),function(e){if(e.Code!=1){App.message({text:e.Info,type:"error"});return}var t=$("#ddns-running-status");if(e.Data.isRunning){if(!t.hasClass("running"))t.addClass("running")}else{t.removeClass("running")}App.message({text:e.Info,type:"success"})},"json")});$('input[name="IPv6[Type]"],input[name="IPv4[Type]"]').on("click",function(){var e=$(this).attr("name");$('div[rel="'+this.id+'"]').show();$('input[name="'+e+'"]:not(:checked)').each(function(){$('div[rel="'+this.id+'"]').hide()})});$('input[name="IPv6[Type]"]:checked,input[name="IPv4[Type]"]:checked').trigger("click");$('input[name="IPv6[Enabled]"],input[name="IPv4[Enabled]"]').on("click",function(){var e=$(this).closest("div.form-group").siblings("div.form-group");if(this.value=="1"){e.removeClass("hide")}else{e.addClass("hide")}});$('input[name="IPv6[Enabled]"]:checked,input[name="IPv4[Enabled]"]:checked').trigger("click");$(".provider-switch-onoff").on("click",function(){var e=$(this).attr("rel"),t=$(this).val()=="1";if(t){$("#"+e).removeClass("hide");$("#"+e).find("[data-required]").prop("required",true);return}$("#"+e+":not(.hide)").addClass("hide");$("#"+e).find(":required").attr("data-required","1").prop("required",false)});$(".provider-switch-onoff:checked").trigger("click");var e="NotifyTemplate[html]";$('textarea[name="NotifyTemplate[html]"],textarea[name="NotifyTemplate[markdown]"]').on("focus",function(){e=$(this).attr("name")});$("#notify-template-tag-values code").on("click",function(){App.insertAtCursor($('textarea[name="'+e+'"]')[0],$(this).text())});$(".webhook-content-tag-values code").on("click",function(){App.insertAtCursor($(this).closest(".help-block").prev("textarea")[0],$(this).text())});$('input[name="IPv4[NetInterface][Filter][Include]"],input[name="IPv4[NetInterface][Filter][Exclude]"]').on("focus",function(){ipv4NetInterfaceIPRule=$(this).attr("name")});$('input[name="IPv6[NetInterface][Filter][Include]"],input[name="IPv6[NetInterface][Filter][Exclude]"]').on("focus",function(){ipv6NetInterfaceIPRule=$(this).attr("name")})});