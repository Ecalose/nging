(function(){var n,i="#CPU-Usage",t="#Net-Usage",r="#NetPacket-Usage",o="#Temp-Stat";function e(e,t,n){return n.series.label+": "+n.datapoint[1].toFixed(2)}function a(e,t,n){return n.series.label+": "+u(n.datapoint[1].toFixed(2),true)}function l(e,t,n){return n.series.label+": "+App.formatBytes(n.datapoint[1])}function s(e,t,n){return n.series.label+": "+n.datapoint[1]+"℃"}function c(e,t){var n=new Date(e);if(t||n.getSeconds()%10==0){var i=n.getHours()<10?"0"+n.getHours():n.getHours();var r=n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes();var o=n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds();return i+":"+r+":"+o}return""}function u(e,t){if(t||e%10==0)return e+"%";return""}App.plotHover(i,a);App.plotHover(t,l);App.plotHover(r,e);App.plotHover(o,s);var d,f,p,h,g={series:{lines:{show:true,lineWidth:2,fill:true,fillColor:{colors:[{opacity:.25},{opacity:.25}]}},points:{show:false},shadowSize:2},legend:{show:true},grid:{labelMargin:10,axisMargin:500,hoverable:true,clickable:true,tickColor:"rgba(0,0,0,0.15)",borderWidth:0},colors:["#B450B2","#4A8CF7","#52e136"],xaxis:{mode:"time",tickSize:[2,"second"],tickFormatter:function(e,t){return c(e)}},yaxis:{min:0,max:100,tickSize:10,tickFormatter:function(e,t){return u(e)}}},w={series:{lines:{show:true,lineWidth:2,fill:true,fillColor:{colors:[{opacity:.25},{opacity:.25}]}},points:{show:false},shadowSize:2},legend:{show:true},grid:{labelMargin:10,axisMargin:500,hoverable:true,clickable:true,tickColor:"rgba(0,0,0,0.15)",borderWidth:0},colors:["#B450B2","#4A8CF7","#52e136"],xaxis:{mode:"time",tickSize:[2,"second"],tickFormatter:function(e,t){return c(e)}},yaxis:{tickFormatter:function(e,t){return App.formatBytes(e)}}},v={series:{lines:{show:true,lineWidth:2,fill:true,fillColor:{colors:[{opacity:.25},{opacity:.25}]}},points:{show:false},shadowSize:2},legend:{show:true},grid:{labelMargin:10,axisMargin:500,hoverable:true,clickable:true,tickColor:"rgba(0,0,0,0.15)",borderWidth:0},colors:["#B450B2","#4A8CF7","#52e136"],xaxis:{mode:"time",tickSize:[2,"second"],tickFormatter:function(e,t){return c(e)}}},m={series:{lines:{show:true,lineWidth:2},points:{show:false},shadowSize:2},legend:{show:true,noColumns:8,container:$("#Temp-Legend")[0]},grid:{labelMargin:10,axisMargin:500,hoverable:true,clickable:true,tickColor:"rgba(0,0,0,0.15)",borderWidth:0},colors:["#B450B2","#4A8CF7","#52e136"],xaxis:{mode:"time",tickSize:[2,"second"],tickFormatter:function(e,t){return c(e)}},yaxis:{tickFormatter:function(e,t){return e+"℃"}}};function b(e){return[{data:e.Net.BytesRecv,label:App.i18n.chart.DOWNLOAD_SPEED},{data:e.Net.BytesSent,label:App.i18n.chart.UPLOAD_SPEED}]}function C(e){f.setData(e);f.setupGrid();f.draw()}function S(e){data=b(e);f=$(t).data("plot");if(!f)return k(data);C(data)}function k(e){$(t+"-Box").removeClass("hidden");f=$.plot($(t),e,w);$(t).data("plot",f)}function A(e){return[{data:e.Net.PacketsRecv,label:App.i18n.chart.RECV_PACKETS},{data:e.Net.PacketsSent,label:App.i18n.chart.SENT_PACKETS}]}function x(e){p.setData(e);p.setupGrid();p.draw()}function B(e){var t=A(e);p=$(r).data("plot");if(!p)return y(t);x(t)}function y(e){$(r+"-Box").removeClass("hidden");p=$.plot($(r),e,v);$(r).data("plot",p)}function M(e){var t=[];for(var n in e.Temp){t.push({data:e.Temp[n],label:n})}m.legend.noColumns=t.length;return t}function F(e){h.setData(e);h.setupGrid();h.draw()}function E(e){var t=M(e);if(m.legend.noColumns<=0)return;h=$(o).data("plot");if(!h)return D(t);F(t)}function D(e){$(o+"-Box").removeClass("hidden");h=$.plot($(o),e,m);$(o).data("plot",h)}function P(e){return[{data:e.CPU,label:App.i18n.chart.CPU_USAGE},{data:e.Mem,label:App.i18n.chart.MEMORY_USAGE}]}function U(e){d.setData(e);d.setupGrid();d.draw()}function _(e){var t=P(e);d=$(i).data("plot");if(!d)return z(t);U(t)}function z(e){$(i+"-Box").removeClass("hidden");d=$.plot($(i),e,g);$(i).data("plot",d)}function N(t){if(n){if(t!=null)t();return false}var e=App.wsURL(BACKEND_URL);n=new WebSocket(e+"/server/dynamic");n.onopen=function(e){if(t!=null)t()};n.onclose=function(e){n=null};n.onmessage=function(e){if($(i).length<1){n.close();W();return}var t=JSON.parse(e.data);_(t);S(t);B(t);E(t)}}function T(){var t=$(i).width();N(function(){var e="ping";if(t<=360){e+=":20"}else if(t<=500){e+=":30"}else if(t<=845){e+=":40"}n.send(e)});if($(i).length<1)W()}function W(){if(typeof window._interval!="undefined"&&window._interval){clearInterval(window._interval)}}function L(){if($("#Temp-Legend").length>0){if($(window).width()>767){var e=$(window).width()-$(".cl-sidebar").width()-100;if(e<200)e=200;$("#Temp-Legend").css("width",e)}else{$("#Temp-Legend").css("width","100%")}}}$(function(){W();T();window._interval=window.setInterval(T,2e3);L();$(window).on("resize",L)})})();