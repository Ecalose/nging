(function(){var i,n="#CPU-Usage",e="#Net-Usage",a="#NetPacket-Usage";function t(t,e,i){return i.series.label+": "+i.datapoint[1].toFixed(2)}function r(t,e,i){return i.series.label+": "+s(i.datapoint[1].toFixed(2),true)}function o(t,e,i){return i.series.label+": "+App.formatBytes(i.datapoint[1])}function l(t,e){var i=new Date(t);if(e||i.getSeconds()%10==0){var n=i.getHours()<10?"0"+i.getHours():i.getHours();var a=i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes();var r=i.getSeconds()<10?"0"+i.getSeconds():i.getSeconds();return n+":"+a+":"+r}return""}function s(t,e){if(e||t%10==0)return t+"%";return""}App.plotHover(n,r);App.plotHover(e,o);App.plotHover(a,t);var c,u,d,f={series:{lines:{show:true,lineWidth:2,fill:true,fillColor:{colors:[{opacity:.25},{opacity:.25}]}},points:{show:false},shadowSize:2},legend:{show:true},grid:{labelMargin:10,axisMargin:500,hoverable:true,clickable:true,tickColor:"rgba(0,0,0,0.15)",borderWidth:0},colors:["#B450B2","#4A8CF7","#52e136"],xaxis:{mode:"time",tickSize:[2,"second"],tickFormatter:function(t,e){return l(t)}},yaxis:{min:0,max:100,tickSize:10,tickFormatter:function(t,e){return s(t)}}},p={series:{lines:{show:true,lineWidth:2,fill:true,fillColor:{colors:[{opacity:.25},{opacity:.25}]}},points:{show:false},shadowSize:2},legend:{show:true},grid:{labelMargin:10,axisMargin:500,hoverable:true,clickable:true,tickColor:"rgba(0,0,0,0.15)",borderWidth:0},colors:["#B450B2","#4A8CF7","#52e136"],xaxis:{mode:"time",tickSize:[2,"second"],tickFormatter:function(t,e){return l(t)}},yaxis:{tickFormatter:function(t,e){return App.formatBytes(t)}}},g={series:{lines:{show:true,lineWidth:2,fill:true,fillColor:{colors:[{opacity:.25},{opacity:.25}]}},points:{show:false},shadowSize:2},legend:{show:true},grid:{labelMargin:10,axisMargin:500,hoverable:true,clickable:true,tickColor:"rgba(0,0,0,0.15)",borderWidth:0},colors:["#B450B2","#4A8CF7","#52e136"],xaxis:{mode:"time",tickSize:[2,"second"],tickFormatter:function(t,e){return l(t)}}};function h(t){return[{data:t.Net.BytesRecv,label:App.i18n.chart.DOWNLOAD_SPEED},{data:t.Net.BytesSent,label:App.i18n.chart.UPLOAD_SPEED}]}function w(t){u.setData(t);u.setupGrid();u.draw()}function b(t){data=h(t);u=$(e).data("plot");if(!u)return v(data);w(data)}function v(t){u=$.plot($(e),t,p);$(e).data("plot",u)}function A(t){return[{data:t.Net.PacketsRecv,label:App.i18n.chart.RECV_PACKETS},{data:t.Net.PacketsSent,label:App.i18n.chart.SENT_PACKETS}]}function S(t){d.setData(t);d.setupGrid();d.draw()}function k(t){data=A(t);d=$(a).data("plot");if(!d)return m(data);S(data)}function m(t){d=$.plot($(a),t,g);$(a).data("plot",d)}function C(t){return[{data:t.CPU,label:App.i18n.chart.CPU_USAGE},{data:t.Mem,label:App.i18n.chart.MEMORY_USAGE}]}function x(t){c.setData(t);c.setupGrid();c.draw()}function y(t){data=C(t);c=$(n).data("plot");if(!c)return E(data);x(data)}function E(t){c=$.plot($(n),t,f);$(n).data("plot",c)}function M(e){if(i){if(e!=null)e();return false}var t=App.wsURL(BACKEND_URL);i=new WebSocket(t+"/server/dynamic");i.onopen=function(t){if(e!=null)e()};i.onclose=function(t){i=null};i.onmessage=function(t){if($(n).length<1){i.close();P();return}var e=JSON.parse(t.data);y(e);b(e);k(e)}}function B(){var e=$(n).width();M(function(){var t="ping";if(e<=360){t+=":20"}else if(e<=500){t+=":30"}else if(e<=845){t+=":40"}i.send(t)});if($(n).length<1)P()}function P(){if(typeof window._interval!="undefined"&&window._interval){clearInterval(window._interval)}}$(function(){P();B();window._interval=window.setInterval(B,2e3)})})();