(function(x){function t(t,r,a){var n=this;return this.on("click.pjax",t,function(t){var e=x.extend({},u(r,a));if(!e.container)e.container=x(this).attr("data-pjax")||n;e.keepjs=x(this).attr("data-keepjs");i(t,e)})}function i(t,e,r){r=u(e,r);var a=t.currentTarget;if(a.tagName.toUpperCase()!=="A")throw"$.fn.pjax or $.pjax.click requires an anchor element";if(t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey)return;if(location.protocol!==a.protocol||location.hostname!==a.hostname)return;if(a.href.indexOf("#")>-1&&s(a)==s(location))return;if(t.isDefaultPrevented())return;var n={url:a.href,container:x(a).attr("data-pjax"),target:a};var i=x.extend({},n,r);var o=x.Event("pjax:click");x(a).trigger(o,[i]);if(!o.isDefaultPrevented()){j(i);t.preventDefault();x(a).trigger("pjax:clicked",[i])}}function e(t,e,r){r=u(e,r);var a=t.currentTarget;var n=x(a);if(a.tagName.toUpperCase()!=="FORM")throw"$.pjax.submit requires a form element";var i={type:(n.attr("method")||"GET").toUpperCase(),url:n.attr("action"),container:n.attr("data-pjax"),target:a};if(i.type!=="GET"&&window.FormData!==undefined){i.data=new FormData(a);i.processData=false;i.contentType=false}else{if(x(a).find(":file").length){return}i.data=x(a).serializeArray()}j(x.extend({},i,r));t.preventDefault()}function j(d){d=x.extend(true,{},x.ajaxSetup(),j.defaults,d);if(typeof d.url==="function"){d.url=d.url()}var n=d.target;var h=b(d.url).hash;var v=d.context=T(d.container);var t=v.selector?v.selector:"#"+v.attr("id");if(!d.data)d.data={};if(Array.isArray(d.data)){d.data.push({name:"_pjax",value:t})}else{d.data._pjax=t}function m(t,e,r){if(!r)r={};r.relatedTarget=n;var a=x.Event(t,r);v.trigger(a,e);return!a.isDefaultPrevented()}var a;d.beforeSend=function(t,e){if(e.type!=="GET"){e.timeout=0}t.setRequestHeader("X-PJAX","true");t.setRequestHeader("X-PJAX-Container",v.selector);if(!m("pjax:beforeSend",[t,e]))return false;if(e.timeout>0){a=setTimeout(function(){if(m("pjax:timeout",[t,d]))t.abort("timeout")},e.timeout);e.timeout=0}var r=b(e.url);if(h)r.hash=h;d.requestUrl=c(r)};d.complete=function(t,e){if(a)clearTimeout(a);m("pjax:complete",[t,e,d]);m("pjax:end",[t,d])};d.error=function(t,e,r){var a=E("",t,d);var n=m("pjax:error",[t,e,r,d]);if(d.type=="GET"&&e!=="abort"&&n){g(a.url)}};d.success=function(t,e,r){var a=j.state;var n=typeof x.pjax.defaults.version==="function"?x.pjax.defaults.version():x.pjax.defaults.version;var i=r.getResponseHeader("X-PJAX-Version");var o=E(t,r,d);var s=b(o.url);if(h){s.hash=h;o.url=s.href}if(n&&i&&n!==i){g(o.url);return}if(!o.contents){g(o.url);return}j.state={id:d.id||y(),url:o.url,title:o.title,container:v.selector,fragment:d.fragment,timeout:d.timeout};if(d.push||d.replace){window.history.replaceState(j.state,o.title,o.url)}var u=x.contains(d.container,document.activeElement);if(u){try{document.activeElement.blur()}catch(t){}}if(o.title)document.title=o.title;m("pjax:beforeReplace",[o.contents,d],{state:j.state,previousState:a});v.html(o.contents);var c=v.find("input[autofocus], textarea[autofocus]").last()[0];if(c&&document.activeElement!==c){c.focus()}S(o.scripts);var l=d.scrollTo;if(h){var f=decodeURIComponent(h.slice(1));var p=document.getElementById(f)||document.getElementsByName(f)[0];if(p)l=x(p).offset().top}if(typeof l=="number")x(window).scrollTop(l);m("pjax:success",[t,e,r,d])};if(!j.state){j.state={id:y(),url:window.location.href,title:document.title,container:v.selector,fragment:d.fragment,timeout:d.timeout};window.history.replaceState(j.state,document.title)}p(j.xhr);j.options=d;var e=j.xhr=x.ajax(d);if(e.readyState>0){if(d.push&&!d.replace){P(j.state.id,w(v));window.history.pushState(null,"",d.requestUrl)}m("pjax:start",[e,d]);m("pjax:send",[e,d])}return j.xhr}function r(t,e){var r={url:window.location.href,push:false,replace:true,scrollTo:false};return j(x.extend(r,u(t,e)))}function g(t){window.history.replaceState(null,"",j.state.url);window.location.replace(t)}var l=true;var f=window.location.href;var a=window.history.state;if(a&&a.container){j.state=a}if("state"in window.history){l=false}function n(t){if(!l){p(j.xhr)}var e=j.state;var r=t.state;var a;if(r&&r.container){if(l&&f==r.url)return;if(e){if(e.id===r.id)return;a=e.id<r.id?"forward":"back"}var n=v[r.id]||[];var i=x(n[0]||r.container),o=n[1];if(i.length){if(e){A(a,e.id,w(i))}var s=x.Event("pjax:popstate",{state:r,direction:a});i.trigger(s);var u={id:r.id,url:r.url,container:i,push:false,fragment:r.fragment,timeout:r.timeout,scrollTo:false};if(o){i.trigger("pjax:start",[null,u]);j.state=r;if(r.title)document.title=r.title;var c=x.Event("pjax:beforeReplace",{state:r,previousState:e});i.trigger(c,[o,u]);i.html(o);i.trigger("pjax:end",[null,u])}else{j(u)}i[0].offsetHeight}else{g(location.href)}}l=false}function o(t){var e=x.isFunction(t.url)?t.url():t.url,r=t.type?t.type.toUpperCase():"GET";var a=x("<form>",{method:r==="GET"?"GET":"POST",action:e,style:"display:none"});if(r!=="GET"&&r!=="POST"){a.append(x("<input>",{type:"hidden",name:"_method",value:r.toLowerCase()}))}var n=t.data;if(typeof n==="string"){x.each(n.split("&"),function(t,e){var r=e.split("=");a.append(x("<input>",{type:"hidden",name:r[0],value:r[1]}))})}else if(x.isArray(n)){x.each(n,function(t,e){a.append(x("<input>",{type:"hidden",name:e.name,value:e.value}))})}else if(typeof n==="object"){var i;for(i in n)a.append(x("<input>",{type:"hidden",name:i,value:n[i]}))}x(document.body).append(a);a.submit()}function p(t){if(t&&t.readyState<4){t.onreadystatechange=x.noop;t.abort()}}function y(){return(new Date).getTime()}function w(t){var e=t.clone();e.find("script").each(function(){if(!this.src)jQuery._data(this,"globalEval",false)});return[t.selector,e.contents()]}function c(t){t.search=t.search.replace(/([?&])(_pjax|_)=[^&]*/g,"");return t.href.replace(/\?($|#)/,"$1")}function b(t){var e=document.createElement("a");e.href=t;return e}function s(t){return t.href.replace(/#.*/,"")}function u(t,e){if(t&&e)e.container=t;else if(x.isPlainObject(t))e=t;else e={container:t};if(e.container)e.container=T(e.container);return e}function T(t){t=x(t);if(!t.length){throw"no pjax container for "+t.selector}else if(t.selector!==""&&t.context===document){return t}else if(t[0].id!==""&&t[0].ownerDocument===document){return t}else if(t.attr("id")){return x("#"+t.attr("id"))}else{throw"cant get selector for pjax container!"}}function d(t,e){return t.filter(e).add(t.find(e))}function h(t){return x.parseHTML(t,document,true)}function E(t,e,r){var a={},n=/<html/i.test(t);var i=e.getResponseHeader("X-PJAX-URL");a.url=i?c(b(i)):r.requestUrl;if(n){var o=x(h(t.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0]));var s=x(h(t.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]))}else{var o=s=x(h(t))}if(s.length===0)return a;a.title=d(o,"title").last().text();if(r.fragment){var u;if(r.fragment==="body"){u=s}else{u=d(s,r.fragment).first()}if(u.length){a.contents=r.fragment==="body"?u:u.contents();if(!a.title)a.title=u.attr("title")||u.data("title")}}else if(!n){a.contents=s}if(a.contents){a.contents=a.contents.not(function(){return x(this).is("title")});a.contents.find("title").remove();if(!r.keepjs||r.keepjs=="false"||r.keepjs=="0"){a.scripts=d(a.contents,"script[src]").remove();a.contents=a.contents.not(a.scripts)}}if(a.title)a.title=x.trim(a.title);return a}function S(t){if(!t)return;var n=x("script[src]");t.each(function(){var t=this.src;var e=n.filter(function(){return this.src===t});if(e.length)return;var r=document.createElement("script");var a=x(this).attr("type");if(a)r.type=a;r.src=x(this).attr("src");document.head.appendChild(r)})}var v={};var m=[];var k=[];function P(t,e){v[t]=e;k.push(t);C(m,0);C(k,j.defaults.maxCacheLength)}function A(t,e,r){var a,n;v[e]=r;if(t==="forward"){a=k;n=m}else{a=m;n=k}a.push(e);if(e=n.pop())delete v[e];C(a,j.defaults.maxCacheLength)}function C(t,e){while(t.length>e)delete v[t.shift()]}function D(){return x("meta").filter(function(){var t=x(this).attr("http-equiv");return t&&t.toUpperCase()==="X-PJAX-VERSION"}).attr("content")}function R(){x.fn.pjax=t;x.pjax=j;x.pjax.enable=x.noop;x.pjax.disable=U;x.pjax.click=i;x.pjax.submit=e;x.pjax.reload=r;x.pjax.defaults={timeout:650,push:true,replace:false,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:D,keepjs:false};x(window).on("popstate.pjax",n)}function U(){x.fn.pjax=function(){return this};x.pjax=o;x.pjax.enable=R;x.pjax.disable=x.noop;x.pjax.click=x.noop;x.pjax.submit=x.noop;x.pjax.reload=function(){window.location.reload()};x(window).off("popstate.pjax",n)}if(x.inArray("state",x.event.props)<0)x.event.props.push("state");x.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/);x.support.pjax?R():U()})(jQuery);