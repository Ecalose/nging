function Base64Encode(t){return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Utf8.parse(t))}function Base64Decode(t){return CryptoJS.enc.Base64.parse(t).toString(CryptoJS.enc.Utf8)}function AESEncrypt(t,r,n){var r=CryptoJS.enc.Utf8.parse(r);var n=CryptoJS.enc.Utf8.parse(n);var e=CryptoJS.AES.encrypt(t,r,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return e.toString()}function AESDecrypt(t,r,n){var r=CryptoJS.enc.Utf8.parse(r);var n=CryptoJS.enc.Utf8.parse(n);var e=CryptoJS.AES.decrypt(t,r,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return e.toString(CryptoJS.enc.Utf8)}function AESEncryptECB(t,r){var r=CryptoJS.enc.Utf8.parse(r);var n=CryptoJS.AES.encrypt(t,r,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return n.toString()}function AESDecryptECB(t,r){var r=CryptoJS.enc.Utf8.parse(r);var n=CryptoJS.AES.decrypt(t,r,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return n.toString(CryptoJS.enc.Utf8)}function DESEncrypt(t,r,n){var r=CryptoJS.enc.Utf8.parse(r);var n=CryptoJS.enc.Utf8.parse(n);var e=CryptoJS.DES.encrypt(t,r,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return e.toString()}function DESDecrypt(t,r,n){var r=CryptoJS.enc.Utf8.parse(r);var n=CryptoJS.enc.Utf8.parse(n);var e=CryptoJS.DES.decrypt(t,r,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return e.toString(CryptoJS.enc.Utf8)}function DESEncryptECB(t,r){var r=CryptoJS.enc.Utf8.parse(r);var n=CryptoJS.DES.encrypt(t,r,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return n.toString()}function DESDecryptECB(t,r){var r=CryptoJS.enc.Utf8.parse(r);var n=CryptoJS.DES.decrypt(t,r,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return n.toString(CryptoJS.enc.Utf8)}function SHA256(t){var r=CryptoJS.SHA256(t).toString(CryptoJS.enc.Hex);return r}function MD5(t){var r=CryptoJS.MD5(t).toString(CryptoJS.enc.Hex);return r}function SHA1(t){var r=CryptoJS.SHA1(t).toString(CryptoJS.enc.Hex);return r}function SM2Encrypt(t,r,n){if(n==null)n="1";return SM2Utils.encs(r,t,n)}function encryptFormPassword(t){var r=$(t).serializeArray();var n=$(t).find('input[type="password"]').length;var e=0,p=$(t).attr("data-secret");if(!p)return r;var o=p.split(":",2);p=o[0];for(var a=0;a<r.length;a++){var S=r[a];if($(t).find('input[name="'+S.name+'"][type="password"]').length>0){if(S.value!=""){var c=S.value;if(o.length==2)c=JSON.stringify({p:c,e:o[1],t:(new Date).getTime()});r[a].value=SM2Encrypt(c,p)}e++;if(e>=n)break}}return r}function submitEncryptedData(n,e,p){$(n).on("submit",function(t){t.preventDefault();var r=encryptFormPassword(this);if(e)r=e(this,r);$.post($(this).attr("action"),r,function(t){if(t.Code==1){if(p)return p(t);if(t.URL){if(t.Info){App.message({title:App.i18n.SYS_INFO,text:t.Info,class_name:"success"});window.setTimeout(function(){window.location=t.URL},2e3);return}window.location=t.URL}else{App.message({title:App.i18n.SYS_INFO,text:t.Info?t.Info:App.i18n.SUCCESS,class_name:"success"})}}else{App.captchaUpdate($(n),t);App.message({title:App.i18n.SYS_INFO,text:t.Info?t.Info:App.i18n.FAILURE,class_name:"danger"})}},"json")})}