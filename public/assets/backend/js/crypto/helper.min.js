function Base64Encode(t){return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Utf8.parse(t))}function Base64Decode(t){return CryptoJS.enc.Base64.parse(t).toString(CryptoJS.enc.Utf8)}function AESEncrypt(t,r,e){var r=CryptoJS.enc.Utf8.parse(r);var e=CryptoJS.enc.Utf8.parse(e);var n=CryptoJS.AES.encrypt(t,r,{iv:e,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return n.toString()}function AESDecrypt(t,r,e){var r=CryptoJS.enc.Utf8.parse(r);var e=CryptoJS.enc.Utf8.parse(e);var n=CryptoJS.AES.decrypt(t,r,{iv:e,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return n.toString(CryptoJS.enc.Utf8)}function AESEncryptECB(t,r){var r=CryptoJS.enc.Utf8.parse(r);var e=CryptoJS.AES.encrypt(t,r,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return e.toString()}function AESDecryptECB(t,r){var r=CryptoJS.enc.Utf8.parse(r);var e=CryptoJS.AES.decrypt(t,r,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return e.toString(CryptoJS.enc.Utf8)}function DESEncrypt(t,r,e){var r=CryptoJS.enc.Utf8.parse(r);var e=CryptoJS.enc.Utf8.parse(e);var n=CryptoJS.DES.encrypt(t,r,{iv:e,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return n.toString()}function DESDecrypt(t,r,e){var r=CryptoJS.enc.Utf8.parse(r);var e=CryptoJS.enc.Utf8.parse(e);var n=CryptoJS.DES.decrypt(t,r,{iv:e,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return n.toString(CryptoJS.enc.Utf8)}function DESEncryptECB(t,r){var r=CryptoJS.enc.Utf8.parse(r);var e=CryptoJS.DES.encrypt(t,r,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return e.toString()}function DESDecryptECB(t,r){var r=CryptoJS.enc.Utf8.parse(r);var e=CryptoJS.DES.decrypt(t,r,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return e.toString(CryptoJS.enc.Utf8)}function SHA256(t){var r=CryptoJS.SHA256(t).toString(CryptoJS.enc.Hex);return r}function MD5(t){var r=CryptoJS.MD5(t).toString(CryptoJS.enc.Hex);return r}function SHA1(t){var r=CryptoJS.SHA1(t).toString(CryptoJS.enc.Hex);return r}function SM2Encrypt(t,r,e){if(e==null)e="1";return SM2Utils.encs(r,t,e)}function encryptFormPassword(t){var r=$(t).serializeArray();var e=$(t).find('input[type="password"]').length;var n=0,p=$(t).attr("data-secret");if(!p)return r;var o=p.split(":",2);p=o[0];for(var a=0;a<r.length;a++){var i=r[a];if($(t).find('input[name="'+i.name+'"][type="password"]').length>0){if(i.value!=""){var S=i.value;if(o.length==2)S=JSON.stringify({p:S,e:o[1],t:(new Date).getTime()});r[a].value=SM2Encrypt(S,p)}n++;if(n>=e)break}}return r}function submitEncryptedData(p,o,a){$(p).on("submit",function(t){t.preventDefault();var r=$(this).find(":submit");if(r.children("fa-refresh").length>0)return;var e=encryptFormPassword(this);if(o)e=o(this,e);r.prepend('<i class="fa fa-refresh fa-spin"></i>');r.prop("disabled",true);var n=function(){r.children(".fa-refresh").remove();r.prop("disabled",false)};$.post($(this).attr("action"),e,function(t){n();if(t.Code==1){if(a)return a(t);if(t.URL){if(t.Info){App.message({title:App.i18n.SYS_INFO,text:t.Info,class_name:"success"});window.setTimeout(function(){window.location=t.URL},2e3);return}window.location=t.URL}else{App.message({title:App.i18n.SYS_INFO,text:t.Info?t.Info:App.i18n.SUCCESS,class_name:"success"})}}else{App.captchaUpdate($(p),t);App.message({title:App.i18n.SYS_INFO,text:t.Info?t.Info:App.i18n.FAILURE,class_name:"danger"})}},"json").error(function(t,r,e){n()})})}